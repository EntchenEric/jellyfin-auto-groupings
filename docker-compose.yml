# ─────────────────────────────────────────────────────────────
# docker-compose.yml  –  Deployment for Jellyfin Groupings
# ─────────────────────────────────────────────────────────────

services:
  jellyfin-groupings:
    image: ghcr.io/entcheneric/jellyfin-groupings:latest
    # build: . # Uncomment this if you want to build from source locally
    container_name: jellyfin-groupings
    restart: unless-stopped
    ports:
      - "5000:5000"
    volumes:
      # 1. Config persistence
      # Stores your API keys and group definitions. 
      # The app auto-creates config.json on first start.
      - ./config:/app/config

      # 2. Output directory (Virtual Root)
      # This is where the symlink folders will be created.
      # IMPORTANT: This same host path MUST be mounted in your Jellyfin container.
      # In the Web UI, set "Base Target Path" to: /groupings
      - /path/to/your/groupings-virtual:/groupings

      # 3. Media root
      # Mount your real media folder here so the container can verify symlink targets.
      # In the Web UI, set "Same path on this machine" to: /media
      # - /path/to/your/media:/media:ro

    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 5s
